{"version":3,"file":"dropzone.min.js","sources":["../../src/dragdrop/dropzone.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * JavaScript for the drop zone component.\n *\n * @module    mod_quiz/dragdrop/dropzone\n * @copyright 2024 The Open University\n * @license   http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\nimport {BaseComponent, DragDrop} from 'core/reactive';\nimport {CSS, SELECTORS} from 'mod_quiz/dragdrop/selectors';\nimport {slot} from 'mod_quiz/quiz_utils';\n\nexport default class extends BaseComponent {\n\n    /**\n     * The state is ready.\n     */\n    stateReady() {\n        this.dragdrop = new DragDrop(this);\n    }\n\n    /**\n     * Remove all subcomponents dependencies.\n     */\n    destroy() {\n        // The draggable element must be unregistered.\n        if (this.dragdrop !== undefined) {\n            this.dragdrop.unregister();\n        }\n    }\n\n    /**\n     * Validate draggable data.\n     *\n     * @param {Object} dropdata Drop data from the current drag element.\n     * @returns {boolean} if the data is valid for this drop-zone.\n     */\n    validateDropData(dropdata) {\n        // Do not allow element drop to itself.\n        if (this.element.id == dropdata.id) {\n            this.element.classList.remove(CSS.DROP_ZONE);\n            return false;\n        }\n        return true;\n    }\n\n    /**\n     * Executed when a valid dropdata is dropped over the drop-zone.\n     *\n     * @param {Object} dropdata  Drop data from the current drag element.\n     */\n    drop(dropdata) {\n        let dropZoneNode = this.element;\n        // If the dropzone is a section. We will drop the first question of the section.\n        if (this.element.classList.contains('section')) {\n            dropZoneNode = this.element.querySelector(SELECTORS.QUESTION);\n        }\n        // If the dropzone is a page title. We will drop to next question of the page.\n        if (this.element.classList.contains('page')) {\n            dropZoneNode = slot.getNext(this.element, SELECTORS.SLOT_SELECTOR);\n            if (!dropZoneNode) {\n                // If it is first page, we will drop next the first question of the section.\n                dropZoneNode = this.element.parentNode.querySelector(SELECTORS.QUESTION);\n            }\n        }\n        if (dropZoneNode) {\n            this.reactive.dispatch('moveQuestion', dropdata, dropZoneNode);\n        }\n    }\n\n    /**\n     * Optional method to show some visual hints to the user.\n     */\n    showDropZone() {\n        this.element.classList.add(CSS.DROP_ZONE);\n    }\n\n    /**\n     * Optional method to remove visual hints to the user.\n     */\n    hideDropZone() {\n        this.element.classList.remove(CSS.DROP_ZONE);\n    }\n}"],"names":["BaseComponent","stateReady","dragdrop","DragDrop","this","destroy","undefined","unregister","validateDropData","dropdata","element","id","classList","remove","CSS","DROP_ZONE","drop","dropZoneNode","contains","querySelector","SELECTORS","QUESTION","slot","getNext","SLOT_SELECTOR","parentNode","reactive","dispatch","showDropZone","add","hideDropZone"],"mappings":";;;;;;;;uBA2B6BA,wBAKzBC,kBACSC,SAAW,IAAIC,mBAASC,MAMjCC,eAE0BC,IAAlBF,KAAKF,eACAA,SAASK,aAUtBC,iBAAiBC,iBAETL,KAAKM,QAAQC,IAAMF,SAASE,UACvBD,QAAQE,UAAUC,OAAOC,eAAIC,YAC3B,GAUfC,KAAKP,cACGQ,aAAeb,KAAKM,QAEpBN,KAAKM,QAAQE,UAAUM,SAAS,aAChCD,aAAeb,KAAKM,QAAQS,cAAcC,qBAAUC,WAGpDjB,KAAKM,QAAQE,UAAUM,SAAS,UAChCD,aAAeK,iBAAKC,QAAQnB,KAAKM,QAASU,qBAAUI,eAC/CP,eAEDA,aAAeb,KAAKM,QAAQe,WAAWN,cAAcC,qBAAUC,YAGnEJ,mBACKS,SAASC,SAAS,eAAgBlB,SAAUQ,cAOzDW,oBACSlB,QAAQE,UAAUiB,IAAIf,eAAIC,WAMnCe,oBACSpB,QAAQE,UAAUC,OAAOC,eAAIC"}