{"version":3,"file":"dragdrop.min.js","sources":["../../src/dragdrop/dragdrop.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * JavaScript for the drag drop component.\n *\n * @module    mod_quiz/dragdrop/dragdrop\n * @copyright 2024 The Open University\n * @license   http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\nimport {BaseComponent, DragDrop} from 'core/reactive';\nimport {SELECTORS} from 'mod_quiz/dragdrop/selectors';\nimport {util} from 'mod_quiz/quiz_utils';\n\nexport default class extends BaseComponent {\n\n    /**\n     * Called after the component was created.\n     *\n     * @param {Object} descriptor\n     */\n    create(descriptor) {\n\n        /**\n         * Called after the component was created.\n         */\n        this.id = descriptor.id;\n        this.quizid = descriptor.quizid;\n        this.courseid = descriptor.courseid;\n    }\n\n    /**\n     * The state is ready.\n     */\n    stateReady() {\n        this.dragdrop = new DragDrop(this);\n    }\n\n    /**\n     * Watchers for this component.\n     * @returns {array} All watchers for this component\n     */\n    getWatchers() {\n        return [\n            {watch: `question:updated`, handler: this._slotUpdated},\n        ];\n    }\n\n    /**\n     * Remove all subcomponents dependencies.\n     */\n    destroy() {\n        // The draggable element must be unregistered.\n        if (this.dragdrop !== undefined) {\n            this.dragdrop.unregister();\n        }\n    }\n\n    /**\n     * Update the UI after slot is updated.\n     *\n     * @param {Object} element\n     * @private\n     */\n    _slotUpdated(element) {\n        if (element.element.id == this.id && element.element.ismove) {\n            const dragElement = document.getElementById(element.element.id);\n            const dropZoneElement = document.getElementById(element.element.previousslotid);\n            dropZoneElement.parentNode.insertBefore(dragElement,\n                element.element.goingup ? dropZoneElement : dropZoneElement.nextSibling);\n        }\n    }\n\n    /**\n     * Get the draggable data of this component.\n     *\n     * @returns {Object} the draggable data.\n     */\n    getDraggableData() {\n        // This data will be passed to the drop-zones.\n        const element = document.getElementById(this.id);\n        const sectionId = util.getNumber(element.closest(SELECTORS.MAIN_SECTION).id);\n\n        return {id: this.id, slotorder: element.dataset.slotorder, page: element.dataset.page,\n            courseid: this.courseid, quizid: this.quizid, sectionid: sectionId};\n    }\n}"],"names":["BaseComponent","create","descriptor","id","quizid","courseid","stateReady","dragdrop","DragDrop","this","getWatchers","watch","handler","_slotUpdated","destroy","undefined","unregister","element","ismove","dragElement","document","getElementById","dropZoneElement","previousslotid","parentNode","insertBefore","goingup","nextSibling","getDraggableData","sectionId","util","getNumber","closest","SELECTORS","MAIN_SECTION","slotorder","dataset","page","sectionid"],"mappings":";;;;;;;;uBA2B6BA,wBAOzBC,OAAOC,iBAKEC,GAAKD,WAAWC,QAChBC,OAASF,WAAWE,YACpBC,SAAWH,WAAWG,SAM/BC,kBACSC,SAAW,IAAIC,mBAASC,MAOjCC,oBACW,CACH,CAACC,yBAA2BC,QAASH,KAAKI,eAOlDC,eAE0BC,IAAlBN,KAAKF,eACAA,SAASS,aAUtBH,aAAaI,YACLA,QAAQA,QAAQd,IAAMM,KAAKN,IAAMc,QAAQA,QAAQC,OAAQ,OACnDC,YAAcC,SAASC,eAAeJ,QAAQA,QAAQd,IACtDmB,gBAAkBF,SAASC,eAAeJ,QAAQA,QAAQM,gBAChED,gBAAgBE,WAAWC,aAAaN,YACpCF,QAAQA,QAAQS,QAAUJ,gBAAkBA,gBAAgBK,cASxEC,yBAEUX,QAAUG,SAASC,eAAeZ,KAAKN,IACvC0B,UAAYC,iBAAKC,UAAUd,QAAQe,QAAQC,qBAAUC,cAAc/B,UAElE,CAACA,GAAIM,KAAKN,GAAIgC,UAAWlB,QAAQmB,QAAQD,UAAWE,KAAMpB,QAAQmB,QAAQC,KAC7EhC,SAAUI,KAAKJ,SAAUD,OAAQK,KAAKL,OAAQkC,UAAWT"}