define("mod_quiz/dragdrop/mutations",["exports","core/ajax","mod_quiz/dragdrop/selectors","mod_quiz/quiz_utils","mod_quiz/quiz_toolboxes"],(function(_exports,_ajax,_selectors,_quiz_utils,_quiz_toolboxes){var obj;
/**
   * JavaScript for Mutations library.
   *
   * @module    mod_quiz/dragdrop/mutations
   * @copyright 2024 The Open University
   * @license   http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
   */Object.defineProperty(_exports,"__esModule",{value:!0}),_exports.default=void 0,_ajax=(obj=_ajax)&&obj.__esModule?obj:{default:obj};return _exports.default=class{async moveQuestion(stateManager,dragData,dropZoneNode){const goingUp=dragData.slotorder>dropZoneNode.dataset.slotorder;this.processUpdates(stateManager,dropZoneNode,dragData,goingUp);const dragNode=document.getElementById(dragData.id);let previousSlot=_quiz_utils.slot.getPrevious(dragNode,_selectors.SELECTORS.SLOT_SELECTOR),previousPage=_quiz_utils.slot.getPrevious(dragNode,_selectors.SELECTORS.PAGE_SELECTOR);previousSlot=previousSlot?_quiz_utils.util.getNumber(previousSlot.id):0,previousPage=previousPage?_quiz_utils.util.getNumber(previousPage.id):0;(await this._moveQuestionToSlot(dragData.quizid,_quiz_utils.util.getNumber(dragData.id),_quiz_utils.util.getNumber(dragNode.closest(_selectors.SELECTORS.MAIN_SECTION).id),previousSlot,previousPage)).visible&&(0,_quiz_toolboxes.initResourceToolbox)(dragData.courseid,dragData.quizid,!1).reorganiseEditPage()}async _moveQuestionToSlot(quizid,slotid,sectionid,previousslotid,page){return _ajax.default.call([{methodname:"mod_quiz_move_slot",args:{quizid:quizid,id:slotid,previousid:previousslotid,sectionid:sectionid,page:page}}])[0]}async processUpdates(stateManager,dropZoneNode,dragData,goingup){const updateUI={name:"question",action:"put",fields:{id:dragData.id,ismove:!0,goingup:goingup,dropzoneslotorder:dropZoneNode.dataset.slotorder,dragslotoder:dragData.slotorder,previousslotid:dropZoneNode.id}};stateManager.processUpdates([updateUI]);const revertIsMoveState={name:"question",action:"put",fields:{id:dragData.id,ismove:!1}};stateManager.processUpdates([revertIsMoveState])}},_exports.default}));

//# sourceMappingURL=mutations.min.js.map