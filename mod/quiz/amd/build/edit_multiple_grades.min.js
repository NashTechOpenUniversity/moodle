define("mod_quiz/edit_multiple_grades",["exports","core/ajax","core/config","core/loadingicon","core/notification","core/pending","core/str","core/templates","core/prefetch","core/fragment"],(function(_exports,_ajax,_config,_loadingicon,_notification,_pending,_str,Templates,_prefetch,_fragment){function _getRequireWildcardCache(nodeInterop){if("function"!=typeof WeakMap)return null;var cacheBabelInterop=new WeakMap,cacheNodeInterop=new WeakMap;return(_getRequireWildcardCache=function(nodeInterop){return nodeInterop?cacheNodeInterop:cacheBabelInterop})(nodeInterop)}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}
/**
   * JavaScript for managing multiple grade items for a quiz.
   *
   * @module     mod_quiz/edit_multiple_grades
   * @copyright  2023 The Open University
   * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
   */Object.defineProperty(_exports,"__esModule",{value:!0}),_exports.init=void 0,_config=_interopRequireDefault(_config),_notification=_interopRequireDefault(_notification),_pending=_interopRequireDefault(_pending),Templates=function(obj,nodeInterop){if(!nodeInterop&&obj&&obj.__esModule)return obj;if(null===obj||"object"!=typeof obj&&"function"!=typeof obj)return{default:obj};var cache=_getRequireWildcardCache(nodeInterop);if(cache&&cache.has(obj))return cache.get(obj);var newObj={},hasPropertyDescriptor=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var key in obj)if("default"!==key&&Object.prototype.hasOwnProperty.call(obj,key)){var desc=hasPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):null;desc&&(desc.get||desc.set)?Object.defineProperty(newObj,key,desc):newObj[key]=obj[key]}newObj.default=obj,cache&&cache.set(obj,newObj);return newObj}(Templates),_fragment=_interopRequireDefault(_fragment);const SELECTORS_addGradeItemButton="#mod_quiz-add_grade_item",SELECTORS_autoSetupButton="#mod_quiz-grades_auto_setup",SELECTORS_editingPageContents="#edit_grading_page-contents",SELECTORS_gradeItemList="table#mod_quiz-grade-item-list",SELECTORS_gradeItemSelect="select[data-slot-id]",SELECTORS_gradeItemSelectId=id=>"select#grade-item-choice-"+id,SELECTORS_gradeItemTr="table#mod_quiz-grade-item-list tr[data-quiz-grade-item-id]",SELECTORS_inplaceEditable="span.inplaceeditable",SELECTORS_inplaceEditableOn="span.inplaceeditable.inplaceeditingon",SELECTORS_resetAllButton="#mod_quiz-grades_reset_all",SELECTORS_slotList="table#mod_quiz-slot-list",SELECTORS_updateGradeItemLink=id=>'tr[data-quiz-grade-item-id="'+id+'"] .quickeditlink';(0,_prefetch.prefetchStrings)("mod_quiz",["overallfeedback_for","insertfeedbackbefore","editoverallfeedback","overallfeedback1range"]);let totalEditor={};const callServiceAndReturnRenderingData=methodCall=>callServicesAndReturnRenderingData([methodCall]),callServicesAndReturnRenderingData=methodCalls=>(methodCalls.push({methodname:"mod_quiz_get_edit_grading_page_data",args:{quizid:methodCalls[0].args.quizid}}),Promise.all((0,_ajax.call)(methodCalls)).then((results=>JSON.parse(results.at(-1))))),handleDeleteFeedback=e=>{const feedbackElement=e.currentTarget.closest('[data-groupname="gradeitem-feedback"]'),overallFeedbackWrapper=feedbackElement.closest(".wrap-overallfeedback-form"),after=Number(feedbackElement.nextElementSibling.querySelector("button.feedbackadd-button").dataset.after);feedbackElement.previousElementSibling.remove(),feedbackElement.nextElementSibling.remove(),feedbackElement.remove(),recalculateFeedbackIndex(overallFeedbackWrapper,after,Number(document.querySelector(SELECTORS_gradeItemList).dataset.contextId))},handleSubmitForm=e=>{var _target$closest,_target$closest2;e.preventDefault();const target=e.currentTarget,action=target.dataset.action,gradeItemId=parseInt(target.closest("div[data-gradeitem-id]").dataset.gradeitemId);switch(action){case"cancel":null===(_target$closest=target.closest(".wrap-sub-table"))||void 0===_target$closest||_target$closest.querySelector(".wrap-overallfeedback-form").classList.add("d-none"),null===(_target$closest2=target.closest(".wrap-sub-table"))||void 0===_target$closest2||_target$closest2.querySelector(".wrap-overallfeedback-detail").classList.remove("d-none"),toggleFeedbackDetailElements(gradeItemId,!1);break;case"save":saveFeedback(gradeItemId)}},toggleFeedbackDetailElements=(gradeItemID,status)=>{var _document$querySelect;!document.getElementById("overall-feedback-detail-"+gradeItemID).classList.contains("show")===status&&(null===(_document$querySelect=document.querySelector(SELECTORS_gradeItemList+' tr[data-quiz-grade-item-id="'.concat(gradeItemID,'"] > th a.view-detail')))||void 0===_document$querySelect||_document$querySelect.click())},updateStatusFooterButton=(gradeItemId,status)=>{document.getElementById("overall-feedback-detail-"+gradeItemId).querySelectorAll(".overallfeedback-footer input").forEach((inputEl=>{inputEl.disabled=status}))},saveFeedback=async gradeItemId=>{const formData=collectFormData(gradeItemId);updateStatusFooterButton(gradeItemId,!0);const options={methodname:"mod_quiz_save_overall_feedback_per_grade_item",args:{formdata:JSON.stringify(formData),quizid:parseInt(document.querySelector(SELECTORS_gradeItemList).dataset.quizId),gradeitemid:gradeItemId}};try{const result=await(0,_ajax.call)([options])[0],errors=JSON.parse(result.errors);if(displayErrors(gradeItemId,errors),0===errors.length){const gradeItemRow=document.querySelector(SELECTORS_gradeItemList+' tr[data-quiz-grade-item-id="'.concat(gradeItemId,'"]')),addOverallFeedbackMenu=gradeItemRow.querySelector(".moodle-actionmenu a.dropdown-item[data-action-add-feedback]"),{key:key,title:title,titleLevelFeedback:titleLevelFeedback}=await getIconFeedback(parseInt(result.total)),icon=await Templates.renderPix(key,"core",title);if(addOverallFeedbackMenu.innerHTML=icon+title,gradeItemRow.querySelector("td.total-overallfeedback").innerText=titleLevelFeedback,0===parseInt(result.total)){var _gradeItemRow$querySe,_gradeItemRow$querySe2,_gradeItemRow$querySe3;toggleFeedbackDetailElements(gradeItemId,!1),null===(_gradeItemRow$querySe=gradeItemRow.querySelector(SELECTORS_inplaceEditable))||void 0===_gradeItemRow$querySe||null===(_gradeItemRow$querySe2=_gradeItemRow$querySe.querySelector("a.view-detail:not(.invisible)"))||void 0===_gradeItemRow$querySe2||null===(_gradeItemRow$querySe3=_gradeItemRow$querySe2.classList)||void 0===_gradeItemRow$querySe3||_gradeItemRow$querySe3.add("invisible")}else{var _gradeItemRow$querySe4,_gradeItemRow$querySe5,_gradeItemRow$querySe6;null===(_gradeItemRow$querySe4=gradeItemRow.querySelector(SELECTORS_inplaceEditable))||void 0===_gradeItemRow$querySe4||null===(_gradeItemRow$querySe5=_gradeItemRow$querySe4.querySelector("a.invisible"))||void 0===_gradeItemRow$querySe5||null===(_gradeItemRow$querySe6=_gradeItemRow$querySe5.classList)||void 0===_gradeItemRow$querySe6||_gradeItemRow$querySe6.remove("invisible");const pending=new _pending.default("updating-feedback-detail"),feedbackWrapElement=document.getElementById("overall-feedback-detail-"+gradeItemId);(0,_loadingicon.addIconToContainerRemoveOnCompletion)(feedbackWrapElement.querySelector(".wrap-sub-table"),pending),_fragment.default.loadFragment("mod_quiz","load_overall_feedback_detail",Number(document.querySelector(SELECTORS_gradeItemList).dataset.contextId),{quizId:parseInt(document.querySelector(SELECTORS_gradeItemList).dataset.quizId),gradeItemId:gradeItemId}).then((function(html){return feedbackWrapElement.querySelector(".wrap-overallfeedback-detail").innerHTML=html,feedbackWrapElement.querySelector(".wrap-overallfeedback-form").classList.add("d-none"),feedbackWrapElement.querySelector(".wrap-overallfeedback-form").innerHTML="",feedbackWrapElement.querySelector(".wrap-overallfeedback-detail").classList.remove("d-none"),pending.resolve(),!0})).catch(_notification.default.exception)}}updateStatusFooterButton(gradeItemId,!1)}catch(e){updateStatusFooterButton(gradeItemId,!1),_notification.default.exception(e)}},getIconFeedback=async totalFeedback=>totalFeedback>0?{key:"t/edit",title:await(0,_str.get_string)("editoverallfeedback","quiz"),titleLevelFeedback:1===totalFeedback?await(0,_str.get_string)("overallfeedback1range","quiz",totalFeedback):await(0,_str.get_string)("overallfeedbacknranges","quiz",totalFeedback)}:{key:"t/add",title:await(0,_str.get_string)("addoverallfeedback","quiz"),titleLevelFeedback:"-"},displayErrors=(gradeItemId,errors)=>{const feedbackForm=document.getElementById("overall-feedback-detail-"+gradeItemId);let feedbackTextIndex=0;feedbackForm.querySelectorAll("form .fitem").forEach((el=>{var _el$querySelector,_el$querySelector$dat;switch(null===(_el$querySelector=el.querySelector("[data-fieldtype]"))||void 0===_el$querySelector||null===(_el$querySelector$dat=_el$querySelector.dataset)||void 0===_el$querySelector$dat?void 0:_el$querySelector$dat.fieldtype){case"text":{const inputBoundary=el.querySelector('input[name^="feedbackboundaries"]'),errorText=errors[inputBoundary.name],feedback=inputBoundary.closest(".felement").querySelector(".invalid-feedback");errorText?(inputBoundary.classList.add("is-invalid"),inputBoundary.setAttribute("autofocus",!0),feedback.classList.add("d-block"),feedback.innerText=errorText,inputBoundary.setAttribute("aria-describedby",feedback.id)):(inputBoundary.classList.remove("is-invalid"),inputBoundary.removeAttribute("autofocus"),feedback.classList.remove("d-block"),feedback.innerText="")}break;case"editor":{if("id_feedbacktext_0_text"===el.querySelector('textarea[name^="feedbacktext"]').id)break;const errorText=errors["feedbacktext[".concat(feedbackTextIndex,"]")],feedbackEl=el.querySelector(".invalid-feedback");errorText?(feedbackEl.innerText=errorText,feedbackEl.classList.add("d-block")):(feedbackEl.innerText="",feedbackEl.classList.remove("d-block")),feedbackTextIndex++}}}))},collectFormData=gradeItemId=>{const formData=[];let itemData={};return document.getElementById("overall-feedback-detail-"+gradeItemId).querySelectorAll(".wrap-overallfeedback-form form").forEach((form=>{[...new FormData(form).entries()].forEach((arr=>{var _itemData$feedback;const[key,value]=arr;if(/^feedbackboundaries/.test(key)&&(itemData.boundary=value.trim()),/^feedbacktext/.test(key)){const type=key.match(/\[(.*?)]/g).pop().slice(1,-1);itemData.feedback||(itemData.feedback={}),itemData.feedback[type]=value.trim()}var _itemData$boundary;3===Object.keys(null!==(_itemData$feedback=itemData.feedback)&&void 0!==_itemData$feedback?_itemData$feedback:{}).length&&(itemData.boundary=null!==(_itemData$boundary=itemData.boundary)&&void 0!==_itemData$boundary?_itemData$boundary:"100%",formData.push({...itemData}),itemData={})}))})),formData},handleAddMoreFeedback=async(e,overallFeedbackWrapper,contextId)=>{const{after:after}=e.currentTarget.dataset,gradeItemId=parseInt(overallFeedbackWrapper.closest("[data-gradeitem-id]").dataset.gradeitemId);_fragment.default.loadFragment("mod_quiz","load_overall_feedback_form",contextId,{after:after,no:totalEditor[gradeItemId],gradeitemid:gradeItemId}).then((function(html,js){return overallFeedbackWrapper.querySelector('.divider button[data-after="'.concat(after,'"]')).closest(".divider").insertAdjacentHTML("afterend",html),Templates.runTemplateJS(js),totalEditor[gradeItemId]++,recalculateFeedbackIndex(overallFeedbackWrapper,after,contextId),!0})).catch(_notification.default.exception)},recalculateFeedbackIndex=(overallFeedbackWrapper,after,contextId)=>{const gradeBoundaryEls=overallFeedbackWrapper.querySelectorAll('input[name^="feedbackboundaries"]'),dividerButtonEls=overallFeedbackWrapper.querySelectorAll(".divider button"),deleteButtonEls=overallFeedbackWrapper.querySelectorAll('button[name="delete-feedback"]');gradeBoundaryEls.forEach(((el,key)=>{if(key>=after){const wrapItem=el.closest(".fitem"),label=wrapItem.querySelector('label[id^="id_feedbackboundaries_"]'),inputBoundary=wrapItem.querySelector('input[name^="feedbackboundaries"]');wrapItem.id="fitem_id_feedbackboundaries_"+key,label.id="id_feedbackboundaries_".concat(key,"_label"),label.setAttribute("for","id_feedbackboundaries_".concat(key)),inputBoundary.id="id_feedbackboundaries_"+key,inputBoundary.name="feedbackboundaries[".concat(key,"]"),wrapItem.querySelector(".invalid-feedback").id="id_error_feedbackboundaries_"+key}})),dividerButtonEls.forEach(((el,key)=>{el.dataset.after=key,(0,_str.get_string)("insertfeedbackbefore","mod_quiz",{afterindex:key}).then((string=>(el.setAttribute("aria-label",string),!0))).catch((()=>!1)),"false"===el.dataset.eventAttached&&(el.dataset.eventAttached="true",el.addEventListener("click",(e=>{e.preventDefault(),handleAddMoreFeedback(e,overallFeedbackWrapper,contextId)})))})),deleteButtonEls.forEach((el=>{var _el$dataset;void 0===(null===(_el$dataset=el.dataset)||void 0===_el$dataset?void 0:_el$dataset.deleteEventAttached)&&(el.dataset.deleteEventAttached="true",el.addEventListener("click",(e=>{e.preventDefault(),handleDeleteFeedback(e)})))}))},handleGradeItemDelete=e=>{e.preventDefault();const pending=new _pending.default("delete-quiz-grade-item"),tableCell=e.target.closest("td");(0,_loadingicon.addIconToContainer)(tableCell,pending);const tableRow=tableCell.closest("tr"),quizId=tableRow.closest("table").dataset.quizId,gradeItemId=tableRow.dataset.quizGradeItemId;let nextItemToFocus;nextItemToFocus=tableRow.nextElementSibling?SELECTORS_updateGradeItemLink(tableRow.nextElementSibling.dataset.quizGradeItemId):SELECTORS_addGradeItemButton,((quizId,gradeItemId)=>callServiceAndReturnRenderingData({methodname:"mod_quiz_delete_grade_items",args:{quizid:quizId,quizgradeitems:[{id:gradeItemId}]}}))(quizId,gradeItemId).then(reRenderPage).then((()=>{var _document$querySelect2;return pending.resolve(),null===(_document$querySelect2=document.querySelector(nextItemToFocus))||void 0===_document$querySelect2||_document$querySelect2.focus(),!0})).catch(_notification.default.exception)},stopEditingGadeItem=editableSpan=>{editableSpan.innerHTML=editableSpan.dataset.oldContent,delete editableSpan.dataset.oldContent,editableSpan.classList.remove("inplaceeditingon"),editableSpan.querySelector("[data-action-edit]").focus()},handleGradeItemKeyDown=e=>{if(13!==e.keyCode)return;const editableSpan=e.target.closest(SELECTORS_inplaceEditableOn);if(!editableSpan||!editableSpan.closest(SELECTORS_gradeItemList))return;e.preventDefault();const pending=new _pending.default("edit-quiz-grade-item-save"),newName=editableSpan.querySelector("input").value,tableCell=e.target.closest("th");(0,_loadingicon.addIconToContainer)(tableCell);const tableRow=tableCell.closest("tr"),quizId=tableRow.closest("table").dataset.quizId,gradeItemId=tableRow.dataset.quizGradeItemId;((quizId,gradeItemId,newName)=>callServiceAndReturnRenderingData({methodname:"mod_quiz_update_grade_items",args:{quizid:quizId,quizgradeitems:[{id:gradeItemId,name:newName}]}}))(quizId,gradeItemId,newName).then(reRenderPage).then((()=>{pending.resolve(),document.querySelector(SELECTORS_updateGradeItemLink(gradeItemId)).focus({focusVisible:!0})})).catch(_notification.default.exception)},reRenderPage=editGradingPageData=>Templates.render("mod_quiz/edit_grading_page",editGradingPageData).then(((html,js)=>Templates.replaceNode(document.querySelector(SELECTORS_editingPageContents),html,js||""))),handleGradeItemKeyUp=e=>{if(27!==e.keyCode)return;const editableSpan=e.target.closest(SELECTORS_inplaceEditableOn);editableSpan&&editableSpan.closest(SELECTORS_gradeItemList)&&(e.preventDefault(),stopEditingGadeItem(editableSpan))},handleGradeItemFocusOut=e=>{if(_config.default.behatsiterunning)return;const editableSpan=e.target.closest(SELECTORS_inplaceEditableOn);editableSpan&&editableSpan.closest(SELECTORS_gradeItemList)&&(e.preventDefault(),stopEditingGadeItem(editableSpan))},handleSlotGradeItemChanged=e=>{const select=e.target.closest(SELECTORS_gradeItemSelect);if(!select||!select.closest(SELECTORS_slotList))return;e.preventDefault();const pending=new _pending.default("edit-slot-grade-item-updated"),slotId=select.dataset.slotId,newGradeItemId=select.value?select.value:null,tableCell=e.target.closest("td");(0,_loadingicon.addIconToContainer)(tableCell,pending);((quizId,slotId,gradeItemId)=>callServiceAndReturnRenderingData({methodname:"mod_quiz_update_slots",args:{quizid:quizId,slots:[{id:slotId,quizgradeitemid:gradeItemId}]}}))(tableCell.closest("table").dataset.quizId,slotId,newGradeItemId).then(reRenderPage).then((()=>{pending.resolve(),document.querySelector(SELECTORS_gradeItemSelectId(slotId)).focus()})).catch(_notification.default.exception)},handleGradeItemClick=e=>{const link=e.target.closest("a");link&&link.closest(SELECTORS_gradeItemList)&&(link.dataset.actionDelete&&handleGradeItemDelete(e),link.dataset.actionEdit&&(e=>{e.preventDefault();const pending=new _pending.default("edit-quiz-grade-item-start"),editableSpan=e.target.closest(SELECTORS_inplaceEditable);document.querySelectorAll(SELECTORS_inplaceEditableOn).forEach(stopEditingGadeItem),editableSpan.dataset.oldContent=editableSpan.innerHTML,(0,_str.get_string)("edittitleinstructions").then((instructions=>{const uniqueId="gi-edit-input-"+editableSpan.closest("tr").dataset.quizGradeItemId;editableSpan.innerHTML='<span class="editinstructions">'+instructions+'</span><label class="visually-hidden" for="'+uniqueId+'">'+editableSpan.dataset.editLabel+'</label><input type="text" id="'+uniqueId+'" value="'+editableSpan.dataset.rawName+'" class="ignoredirty form-control w-100">';const inputElement=editableSpan.querySelector("input");return inputElement.focus(),inputElement.select(),editableSpan.classList.add("inplaceeditingon"),pending.resolve(),null})).catch(_notification.default.exception)})(e),link.dataset.actionAddFeedback&&(async e=>{e.preventDefault();const pending=new _pending.default("add-overall-feedback"),tableRow=e.target.closest("td").closest("tr"),contextId=Number(tableRow.closest("table").dataset.contextId),quizId=tableRow.closest("table").dataset.quizId,gradeItemId=tableRow.dataset.quizGradeItemId,feedbackDetailRow=document.querySelector(SELECTORS_gradeItemList+" #overall-feedback-detail-"+gradeItemId);if(!feedbackDetailRow)return;feedbackDetailRow.classList.contains("show")||tableRow.querySelector("th span.inplaceeditable a.view-detail").click(),feedbackDetailRow.querySelector(".wrap-sub-table .wrap-overallfeedback-detail").classList.add("d-none"),(0,_loadingicon.addIconToContainerRemoveOnCompletion)(feedbackDetailRow.querySelector(".wrap-sub-table"),pending);let totalFeedback=0;_fragment.default.loadFragment("mod_quiz","load_overall_feedback_data",contextId,{quizId:quizId,gradeItemId:gradeItemId}).then((function(html,js){const feedbackFormEl=feedbackDetailRow.querySelector(".wrap-sub-table .wrap-overallfeedback-form");return feedbackFormEl.innerHTML=html,feedbackFormEl.classList.remove("d-none"),setTimeout((()=>{Templates.runTemplateJS(js)}),500),feedbackDetailRow.querySelector(".wrap-sub-table").querySelectorAll(".divider button.feedbackadd-button").forEach((addFeedback=>{totalFeedback++,addFeedback.dataset.eventAttached="true",addFeedback.addEventListener("click",(e=>{e.preventDefault(),handleAddMoreFeedback(e,feedbackFormEl,contextId)}))})),totalEditor[gradeItemId]=totalFeedback,feedbackDetailRow.querySelectorAll(".overallfeedback-footer input").forEach((input=>{input.addEventListener("click",handleSubmitForm),input.removeAttribute("disabled")})),feedbackDetailRow.querySelectorAll('button[name="delete-feedback"]').forEach((button=>{button.dataset.deleteEventAttached="true",button.addEventListener("click",handleDeleteFeedback)})),pending.resolve(),!0})).catch(_notification.default.exception)})(e),link.dataset.actionViewFeedback&&handleGradeItemViewFeedback(e))},handleGradeItemViewFeedback=e=>{e.preventDefault();const target=e.target.closest("a"),action="0"===target.dataset.actionViewFeedback;toggleFeedbackDetail(target,action)},toggleFeedbackDetail=(target,action)=>{const targetClass=action?".collapsed-icon":".expanded-icon";target.querySelector("span.icon:not(".concat(targetClass,")")).classList.add("d-none"),target.querySelector("".concat(targetClass)).classList.remove("d-none"),target.dataset.actionViewFeedback=action?"1":"0"},handleButtonClick=e=>{e.target.closest(SELECTORS_addGradeItemButton)&&handleAddGradeItemClick(e),e.target.closest(SELECTORS_autoSetupButton)&&handleAutoSetup(e),e.target.closest(SELECTORS_resetAllButton)&&handleResetAllClick(e)},handleAddGradeItemClick=e=>{e.preventDefault();const pending=new _pending.default("create-quiz-grade-item");(0,_loadingicon.addIconToContainer)(e.target.parentNode,pending);(quizId=>callServiceAndReturnRenderingData({methodname:"mod_quiz_create_grade_items",args:{quizid:quizId,quizgradeitems:[{name:""}]}}))(e.target.dataset.quizId).then(reRenderPage).then((()=>{pending.resolve(),document.querySelector(SELECTORS_addGradeItemButton).focus()})).catch(_notification.default.exception)},handleAutoSetup=e=>{e.preventDefault();const pending=new _pending.default("setup-quiz-grade-items");(quizId=>callServiceAndReturnRenderingData({methodname:"mod_quiz_create_grade_item_per_section",args:{quizid:quizId}}))(e.target.dataset.quizId).then(reRenderPage).then((()=>{pending.resolve(),document.querySelector(SELECTORS_resetAllButton).focus()})).catch(_notification.default.exception)},handleResetAllClick=e=>{e.preventDefault();const button=e.target;_notification.default.deleteCancelPromise((0,_str.get_string)("gradeitemsremoveallconfirm","quiz"),(0,_str.get_string)("gradeitemsremoveallmessage","quiz"),(0,_str.get_string)("reset"),button).then((()=>reallyResetAll(button))).catch((()=>button.focus()))},reallyResetAll=button=>{const pending=new _pending.default("reset-quiz-grading");(0,_loadingicon.addIconToContainer)(button.parentNode,pending);const quizId=button.dataset.quizId;let methodCalls=[];const slotResets=[...document.querySelectorAll(SELECTORS_gradeItemSelect)].map((select=>({id:select.dataset.slotId,quizgradeitemid:0})));slotResets.length&&methodCalls.push({methodname:"mod_quiz_update_slots",args:{quizid:quizId,slots:slotResets}}),methodCalls.push({methodname:"mod_quiz_delete_grade_items",args:{quizid:quizId,quizgradeitems:[...document.querySelectorAll(SELECTORS_gradeItemTr)].map((tr=>({id:tr.dataset.quizGradeItemId})))}}),callServicesAndReturnRenderingData(methodCalls).then(reRenderPage).then((()=>{pending.resolve(),document.querySelector(SELECTORS_addGradeItemButton).focus()})).catch(_notification.default.exception)};_exports.init=()=>{document.body.addEventListener("click",handleGradeItemClick),document.body.addEventListener("keydown",handleGradeItemKeyDown),document.body.addEventListener("keyup",handleGradeItemKeyUp),document.body.addEventListener("focusout",handleGradeItemFocusOut),document.body.addEventListener("click",handleButtonClick),document.body.addEventListener("change",handleSlotGradeItemChanged)}}));

//# sourceMappingURL=edit_multiple_grades.min.js.map